# Codegen AI Agent Configuration
# –ü—Ä–∞–≤–∏–ª–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã Codegen –∞–≥–µ–Ω—Ç–∞ –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

version: "1.0"

# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–∞
agent:
  name: "Codegen AI Developer"
  role: "Full-Stack Developer"
  capabilities:
    - code_implementation
    - code_review
    - bug_fixing
    - testing
    - documentation
    - refactoring

# –¢—Ä–∏–≥–≥–µ—Ä—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞
triggers:
  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏
  auto_assign:
    enabled: true
    conditions:
      - assignee: "codegen[bot]"
      - label: "codegen-agent"
      - label: "ai-task"
  
  # –ê–∫—Ç–∏–≤–∞—Ü–∏—è —á–µ—Ä–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
  mention:
    enabled: true
    patterns:
      - "@codegen"
      - "/codegen"
  
  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á
  auto_trigger:
    enabled: true
    labels:
      - "bug"
      - "enhancement"
      - "refactor"
      - "tests-needed"
    conditions:
      - complexity: "low"  # –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      - priority: "high"   # –°—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

# Workflow –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á
workflows:
  # –ù–æ–≤—ã–π Issue
  issue:
    steps:
      - name: "Analyze requirements"
        action: "analyze_issue"
        tools:
          - context7  # –î–ª—è –ø–æ–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
          - github_search  # –î–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö issues
      
      - name: "Plan implementation"
        action: "create_plan"
        output: ".codegen/plans/issue-{number}.md"
      
      - name: "Request approval"
        action: "comment"
        template: "plan_approval"
        wait_for: "approval"  # –ñ–¥–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç —á–µ–ª–æ–≤–µ–∫–∞
      
      - name: "Create feature branch"
        action: "create_branch"
        pattern: "codegen/issue-{number}-{slug}"
      
      - name: "Implement solution"
        action: "implement"
        context:
          - ".codegen/context.md"
          - "CLAUDE.md"
          - related_files
      
      - name: "Run tests"
        action: "test"
        commands:
          - "make test"
          - "npm test"
      
      - name: "Create Pull Request"
        action: "create_pr"
        template: "implementation_pr"
        auto_request_review: true
        reviewers:
          - "@team/developers"

  # Pull Request Review
  pull_request_review:
    steps:
      - name: "Analyze changes"
        action: "analyze_pr"
        checks:
          - code_quality
          - security
          - performance
          - test_coverage
      
      - name: "Run static analysis"
        action: "run_checks"
        tools:
          - eslint
          - prettier
          - type_check
      
      - name: "Submit review"
        action: "submit_review"
        template: "code_review"
        auto_approve: false  # –ù–µ –æ–¥–æ–±—Ä—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  
  # Bug Fix
  bug_fix:
    steps:
      - name: "Reproduce bug"
        action: "reproduce"
        create_test: true
      
      - name: "Root cause analysis"
        action: "analyze_bug"
        tools:
          - trace_execution
          - check_logs
      
      - name: "Implement fix"
        action: "fix"
        verify_test: true
      
      - name: "Regression testing"
        action: "test"
        scope: "full"
      
      - name: "Create fix PR"
        action: "create_pr"
        template: "bug_fix_pr"

  # Refactoring
  refactor:
    steps:
      - name: "Analyze current code"
        action: "analyze_code"
        metrics:
          - complexity
          - duplication
          - maintainability
      
      - name: "Plan refactoring"
        action: "plan_refactor"
        safe_mode: true
      
      - name: "Implement refactoring"
        action: "refactor"
        preserve_behavior: true
      
      - name: "Verify tests pass"
        action: "test"
        require_100_percent_pass: true

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
communication:
  # –Ø–∑—ã–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
  language: "ru"  # Russian by default
  
  # –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞
  status_updates:
    enabled: true
    interval: "10m"  # –ö–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
  
  # –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π
  templates:
    plan_approval: |
      ## üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
      
      {plan_details}
      
      **–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** {estimated_time}
      **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:** {affected_files}
      
      –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–ª–∞–Ω –∫–æ–º–∞–Ω–¥–æ–π `/approve` –∏–ª–∏ –≤–Ω–µ—Å–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏.
    
    implementation_pr: |
      ## üöÄ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: {issue_title}
      
      –†–µ—à–∞–µ—Ç #{issue_number}
      
      ### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ
      {changes_summary}
      
      ### –¢–µ—Å—Ç—ã
      {test_summary}
      
      ### Checklist
      - [x] –ö–æ–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
      - [x] –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
      - [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
      - [ ] Code review –ø—Ä–æ–π–¥–µ–Ω
      
      ü§ñ –°–æ–∑–¥–∞–Ω–æ Codegen AI Agent
    
    code_review: |
      ## üîç Code Review
      
      ### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: {overall_rating}
      
      {review_details}
      
      ### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
      {recommendations}
      
      ü§ñ Review by Codegen AI Agent

# –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
security:
  # –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π merge
  auto_merge: false
  
  # –¢—Ä–µ–±–æ–≤–∞—Ç—å human review –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
  require_human_review:
    - path: ".github/workflows/**"
    - path: "infrastructure/**"
    - path: "**/*secret*"
    - path: "**/*config*"
    - type: "breaking_change"
  
  # –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å
  protected_files:
    - ".env"
    - ".env.production"
    - "**/*.key"
    - "**/*.pem"
    - ".git/**"
  
  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã
  limits:
    max_files_per_pr: 50
    max_lines_changed: 1000
    max_execution_time: "30m"

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
integrations:
  # Codegen API
  codegen:
    api_url: "https://api.codegen.com"
    webhook_secret: "${CODEGEN_WEBHOOK_SECRET}"
  
  # Linear –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
  linear:
    enabled: true
    auto_sync: true
    project_id: "${LINEAR_PROJECT_ID}"
  
  # Slack –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  slack:
    enabled: true
    channel: "#dev-ai-agents"
    notify_on:
      - pr_created
      - review_completed
      - error
  
  # CircleCI –¥–ª—è CI/CD
  circleci:
    enabled: true
    wait_for_checks: true
    auto_fix_failures: true

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–µ–π AI
models:
  # –ú–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  planner:
    provider: "anthropic"
    model: "claude-3-5-sonnet-20241022"
    temperature: 0.3
  
  # –ú–æ–¥–µ–ª—å –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞
  implementer:
    provider: "anthropic"
    model: "claude-3-5-sonnet-20241022"
    temperature: 0.1
  
  # –ú–æ–¥–µ–ª—å –¥–ª—è code review
  reviewer:
    provider: "anthropic"
    model: "claude-3-5-sonnet-20241022"
    temperature: 0.2

# –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
monitoring:
  # –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞
  track_metrics: true
  
  metrics:
    - tasks_completed
    - average_time
    - success_rate
    - code_quality_score
    - test_coverage
  
  # Dashboard –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
  dashboard:
    enabled: true
    url: "https://r2r-production/codegen-metrics"
